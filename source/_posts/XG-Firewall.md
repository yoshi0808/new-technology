---
title: XG Firewall
date: 2020-02-23 09:57:41
tags:
 - XG Firewall
categories:
 - Security
#comments: false
---

# Sophos XG Firewall v18の導入

---

## 背景

---

　元々、家庭用の無線ルータだけではセキュリティが不足していると考えてる人は多いと思います。私の場合、個人で持っているファイルなんぞ盗られたところで大きな問題になるわけでなし、と大きく構えておりましたが、数年前よりランサムウェア等の脅威が出てきた事で、それなりの対策が必要と感じてきました。ITの利便性を求めると、街のWIFIからも自宅のリソースに安全に接続したり、家のサーバーを踏み台にしてネットに繋げたいという欲も出てきて、今度はVPNが欲しいなと思い始めました。

　そもそも、iCloudかOneDriveあたりに、腹を括って必要なファイルはどーんと置いておけばいいんですが、漏洩よりも万が一のロストが不安です。それなりの容量だと、クラウドのお金も掛かりますしね。

　もちろん、オンプレの場合は、盗難や火事というリスクもあり、結局はオンプレとクラウドとを併用する事になるんだと思います。やっぱり、個人のセキュリティというものは、ビジネスにおける、リスクを極限まで抑制するという考えでは無く、何かプラスαの安心感を求める程度という事になるのかと思います。情報資産をどう扱うかというのはまた別の機会にでも考えてみたいと思います。この[Sophos XG Firewall Home Edition](https://www.sophos.com/ja-jp/products/free-tools.aspx)は、プロ向けにも関わらず、無料という事もあって、一つ前のバージョンのv17からずっと使わせてもらってます。v18になってから、大幅に機能強化されたのは良かったのですが、残念ながら設定方法が解りづらくなってしまいました。こんなに高機能なものをタダで使わせてもらって、何も貢献しないのもなぁと思い、拙い文章ではありますが、記録していく事にしました。設定を全部投稿するにはどれくらいの時間が掛かるでしょうか、空いた時間に書いていても結局書ききるのは数ヶ月先かもしれません。

{% asset_img xg.png %}

---

## 主な機能

---



 　1. Firewall機能（IPフィルタ、Portフィルタ）
  　2. IPS/WAF(WAFは面倒...)
  　3. DDoS対策機能(個人には不要)
  　4. 国別フィルタ(IPv4のみ)
  　5. コンテンツフィルタ（広告などのブロック）
  　6. VPN（2要素認証対応）
  　7. IPv6対応
  　8. DNAT(Destination NAT※いわゆるInbound接続・ポート解放)
  　9. DNS/DHCP(IPv4,IPv6)



---

XG Firewallの導入メリット

---

1. ドメイン単位にWebサイト毎のカテゴリがされているので、ギャンブルやゲーム、アダルトなどのカテゴリで禁止ルールを設定可能。
2. 接続したくない国に対してアクセス制限が出来る。Webブラウジングはもちろん、自宅にサーバーを建てた場合の接続元を日本からのみに絞る事も可能(IPv4のみ)。
3. XG本体のルート証明書を端末にインストールする事で、IPS(Intrusion Prevention System)によるhttpsの中身を検査出来る(例えばパスワードが掛かっていないzipファイルをhttpsでダウンロードしてもFirewallで検知可能)。
4. 広告ブロッカー[280blocker](https://280blocker.net)のリストが取り込め、広告バナーがカットされ、特にスマホのブラウズは快適。
5. ログ機能が充実している。
6. VPNにおいてパスワード＋ワンタイムパスワードによる認証が可能(Windows、Mac、iOS、Android)
7. エラーをフックし、メールでの通知が行われるので安心。



---

XG Firewallの導入によるデメリット

---

1. 新しいPCが必要(もちろん新品である必要は無いが)。しかも、2枚のネットワークインターフェースが必要。
3. ネットのパフォーマンスが犠牲になる。自分はゲームはやらないので分からないが、回線帯域よりもレイテンシ(遅延)が大きくなる事が想定される。
4. 証明書をインストール出来ない家電TVのネット機能などはIPSのhttpsインターセプトは利用出来ない。Androidも証明書はインストール可能だが、アプリ毎にXGのルート証明書を導入する事が求められ実質利用出来ない。※Win,Mac,iOSは利用可能
5. 何よりも、XG Firewallによる保護はエンドポイントの保護を完全に不要にするものではないため、従来通りウィルス対策ソフトはインストールが必要（と考えている）。
5. まっさらなDiskにインストールする事になり、バックアップが取れない(仮装環境にインストールし、VMのバックアップは可能)。

---

ハードルは高いですが興味のある方はお付き合い頂ければと思います。

