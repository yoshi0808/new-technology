---
title: XG Firewall
date: 2020-02-23 09:57:41
tags:
  - XG Firewall
categories:
  - Security
#comments: false
---

## Sophos XG Firewall v18の導入

---

### 背景

---

元々、家庭用の無線ルータだけではセキュリティが不足していると考えてる人は多いとおもいます。私の場合、個人で持っているファイルなんぞ盗られたところで大きな問題になるわけでなし、と大きく構えておりました。数年前よりランサムウェア等の脅威が出てきた事で、それなりの対策が必要と感じてきました。街のwifiからも自宅のリソースに安全に接続したり、家のサーバーを踏み台にしてネットに繋げたいという欲も出てきて、今度はVPNが欲しいなと思い始めました。

そもそも、iCloudかOneDriveあたりに必要なファイルはどーんと置いておけばいいんですが、漏洩よりも万が一のロストが不安です。それなりの容量だと、クラウドのお金も掛かりますしね。

　オンプレの場合は盗難や火事というリスクもあり、結局はオンプレとクラウドとを併用する事になるんだとおもいます。やっぱり個人のセキュリティというものは、ビジネスにおけるリスクを極限まで抑制するという考えではなく、何かプラス α の安心感を求める程度という事になるのかとおもいます。個人の資産をどう守るかというのはまた別の機会にでも考えてみたいとおもいます。この[Sophos XG Firewall Home Edition](https://www.sophos.com/ja-jp/products/free-tools.aspx)は、プロ向けにもかかわらず無料という事もあって、1つ前のバージョンのv17からずっと使わせてもらってます。v18になってから、大幅に機能強化されたのは良かったのですが、残念ながら設定方法が解りづらくなってしまいました。こんなに高機能なものをタダで使わせてもらって、何も貢献しないのもなぁと思い、記録していく事にしました。設定を全部投稿するにはどれくらいの時間が掛かるでしょうか、空いた時間に書いていても結局書ききるのは数ヶ月先になるやもしれません。

{% asset_img xg.png %}

---

### 主な機能

---

1. Firewall機能（IPフィルター、Portフィルター）
2. IPS/WAF(WAFは面倒)
3. DDoS対策機能（個人には不要）
4. 国別フィルター（IPv4のみ）
5. コンテンツフィルター（広告などのブロック）
6. VPN（2要素認証対応）
7. IPv6対応
8. DNAT（Destination NAT※いわゆるInbound接続・ポート解放）
9. DNS/DHCP(IPv4,IPv6)

---

### XG Firewallの導入メリット

---

1. ドメイン単位にWebサイト毎のカテゴリがされているので、ギャンブルやゲーム、アダルトなどのカテゴリで禁止ルールを設定可能。
2. 接続したくない国に対してアクセス制限ができる。Webブラウジングはもちろん、自宅にサーバーを建てた場合の接続元を日本からのみに絞る事も可能（IPv4のみ）。
3. XG本体のルート証明書を端末にインストールする事で、IPS（Intrusion Prevention System）によるhttpsの中身を検査できる。たとえばパスワードが掛かっていないzipファイルをhttpsでダウンロードしてもFirewallで検知可能。
4. 広告ブロッカー[280blocker](https://280blocker.net)のリストが取り込め、広告バナーがカットされ、とくにスマホのブラウズは快適。
5. ログ機能が充実している。
6. VPNにおいてパスワード＋ワンタイムパスワードによる認証が可能（Windows、Mac、iOS、Android）
7. エラーをフックし、メールでの通知が行われるので安心。

---

### XG Firewallの導入によるデメリット

---

1. 新しいPCが必要（もちろん新品である必要はないが）。しかも、2枚のネットワークインタフェースが必要。
2. ネットのパフォーマンスが犠牲になる。自分はゲームをやらないので分からないが、回線帯域よりもレイテンシ（遅延）が大きくなると想定される。
3. 証明書をインストール出来ない家電TVのネット機能などはIPSのhttpsインターセプトは利用出来ない。Androidも証明書はインストール可能だが、アプリ毎にXGのルート証明書を導入する事が求められ実質利用出来ない。※Win,Mac,iOSは利用可能
4. 何よりも、XG Firewallによる保護はエンドポイントの保護を完全に不要にするものではないため、従来通りウィルス対策ソフトはインストールが必要（と考えている）。
5. まっさらなディスクにインストールする事となり、バックアップが取れない（仮想環境にインストールし、VMのバックアップは可能）。

---

ハードルは高いですが興味のある方はお付き合い頂ければとおもいます。
